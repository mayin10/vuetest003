import{a as p}from"./axios-c0bebe37.js";import{c as _}from"./constant-adb2729d.js";import{_ as b,r as n,o as m,c as y,f as o,g as r,a as c,t as f,F as v,e as E,h as d,k as F}from"./index-85211e2e.js";const N={data(){return{forderList:[],roleList:[],role_id:"",role_name:"",defaultProps:{children:"children",label:"name"},checked_keys:[],treeList:[],right:[{id:1,name:"download",selected:0},{id:2,name:"download + upload",selected:0},{id:3,name:"download + upload + delete",selected:0}]}},created(){this.getForderList(),this.getRoleList()},methods:{getForderList(){p({url:_.folder,method:"get",headers:{Authorization:"Token "+localStorage.token}}).then(e=>{let t=e.data.results.filter(l=>l.p_id==0);t.forEach(l=>{l.children=e.data.results.filter(i=>i.p_id==l.id)}),t.forEach(l=>{l.children.forEach(i=>{i.right=this.right})}),this.forderList=t}).catch(e=>{})},getRoleList(){p({url:_.role,method:"get",headers:{Authorization:"Token "+localStorage.token}}).then(e=>{this.roleList=e.data.results}).catch(e=>{})},getCheckedNodes(){let e=[];this.$refs.tree.getCheckedNodes().forEach(t=>{e.push(t.p_id),e.push(t.id)}),this.checked_keys=new Set(e),this.checked_keys.forEach(t=>{this.assignment(t)})},assignment(e){console.log(_.role_folder),p({url:_.role_folder,method:"post",data:{role:this.role_id,folder:e,right:1},headers:{Authorization:"Token "+localStorage.token}}).then(t=>{console.log(t)}).catch(t=>{console.log(t)})},resetChecked(){this.$refs.tree.setCheckedKeys([])}}},A={style:{margin:"30px"}},R={class:"grid-content bg-purple"},S={style:{margin:"10px"}},B={class:"grid-content bg-purple"},T={style:{margin:"10px"}},V={class:"buttons"};function z(e,t,l,i,s,h){const k=n("el-descriptions"),C=n("el-menu-item"),L=n("el-menu"),g=n("el-col"),u=n("el-button"),x=n("el-tree"),w=n("el-row");return m(),y("div",A,[o(w,{gutter:20},{default:r(()=>[o(g,{span:6},{default:r(()=>[c("div",R,[o(k,{title:"Role Info"}),c("p",S,"Role: "+f(s.role_name),1),o(L,null,{default:r(()=>[(m(!0),y(v,null,E(s.roleList,a=>(m(),F(C,{key:a.id,onClick:I=>{s.role_id=a.id,s.role_name=a.name}},{default:r(()=>[d(f(a.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1}),o(g,{span:18},{default:r(()=>[c("div",B,[o(k,{title:"Folder Info"}),c("p",T,[d("Role: "+f(s.role_name)+" ",1),o(u,{type:"primary",onClick:h.assignment},{default:r(()=>[d("Folder Assignment")]),_:1},8,["onClick"])]),c("div",V,[o(u,{onClick:h.getCheckedNodes},{default:r(()=>[d("get by node")]),_:1},8,["onClick"]),o(u,{onClick:h.resetChecked},{default:r(()=>[d("reset")]),_:1},8,["onClick"])]),o(x,{data:s.forderList,"show-checkbox":"","node-key":"id","default-expand-all":"",ref:"tree","default-checked-keys":s.checked_keys,props:s.defaultProps},null,8,["data","default-checked-keys","props"])])]),_:1})]),_:1})])}const j=b(N,[["render",z]]);export{j as default};
